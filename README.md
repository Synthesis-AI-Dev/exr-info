# exr-info
Package with helper modules to process EXR files generated by renders
Used in convert_exr2png.

## Install

```shell
pip install -e .
```

## Usage

See [convert_exr2png](https://github.com/Synthesis-AI-Dev/convert_exr2png) on how this package is used to read
the header, channels and cryptomatte from an EXR file.

Getting Started:

```python
from pathlib import Path
import numpy as np
from exr_info import Crypto, ExrChannels, ExrDtype, ExrInfo, lin_rgb_to_srgb_colorspace, Renderer

# Create an exr info object
path_exr = Path("./sample.exr")
exr_f = ExrInfo.open(path_exr)

# Print the header of the EXR file
print(exr_f.get_header_str())

# Object holding channel names corresponding to different images (RGB, Normals, Depth, etc)
exr_channels = ExrChannels(exr_f.renderer)

# Read RGB Image
rgb_arr = np.stack(exr_f.read_channels(exr_channels.rgb), axis=-1)

# We need to apply tonemapping to convert the image to SRGB colorspace before saving to a file. EXR files store
# the image in linear RGB colorspace.
rgb_tonemapped = lin_rgb_to_srgb_colorspace(rgb_arr)
rgb = (rgb_tonemapped * 255).astype(np.uint8)

# Read a cryptomatte
crypto = Crypto(exr_f)
segmentation_crypto_name = "segmentation"  # Every cryptomatte has a name. See the header of the EXR file.
mask, mapping = crypto.get_combined_mask(segmentation_crypto_name)
```
